
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
      <link rel="icon" href="../logo.png">
      <meta name="generator" content="mkdocs-1.2.2, mkdocs-material-7.3.0">
    
    
      
        <title>Configuration - Splunk Connect for Syslog</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.8b42a75e.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.3f5d1f46.min.css">
        
          
          
          <meta name="theme-color" content="#000000">
        
      
    
    
    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>:root{--md-text-font-family:"Roboto";--md-code-font-family:"Roboto Mono"}</style>
      
    
    
    
    
      


    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="black" data-md-color-accent="orange">
  
    
    <script>function __prefix(e){return new URL("..",location).pathname+"."+e}function __get(e,t=localStorage){return JSON.parse(t.getItem(__prefix(e)))}</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#sc4s-configuration-variables" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="Splunk Connect for Syslog" class="md-header__button md-logo" aria-label="Splunk Connect for Syslog" data-md-component="logo">
      
  <img src="../logo.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Splunk Connect for Syslog
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Configuration
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="Splunk Connect for Syslog" class="md-nav__button md-logo" aria-label="Splunk Connect for Syslog" data-md-component="logo">
      
  <img src="../logo.png" alt="logo">

    </a>
    Splunk Connect for Syslog
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        Home
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2" type="checkbox" id="__nav_2" >
      
      
      
      
        <label class="md-nav__link" for="__nav_2">
          Getting Started
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Getting Started" data-md-level="1">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          Getting Started
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../gettingstarted/" class="md-nav__link">
        Read First
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../gettingstarted/podman-systemd-general/" class="md-nav__link">
        Podman + systemd
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../gettingstarted/docker-systemd-general/" class="md-nav__link">
        Docker CE + systemd
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../gettingstarted/k8s-microk8s/" class="md-nav__link">
        MicroK8s + Linux
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../gettingstarted/docker-swarm-general/" class="md-nav__link">
        Docker Compose
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../gettingstarted/docker-compose-MacOS/" class="md-nav__link">
        Docker Desktop + Compose (MacOS)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../gettingstarted/byoe-rhel8/" class="md-nav__link">
        Bring your own Envionment
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../gettingstarted/quickstart_guide/" class="md-nav__link">
        Quickstart Guide
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Configuration
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Configuration
      </a>
      
        
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#global-configuration" class="md-nav__link">
    Global Configuration
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#configure-use-of-external-http-proxy" class="md-nav__link">
    Configure use of external http proxy
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#splunk-hec-destination-configuration" class="md-nav__link">
    Splunk HEC Destination Configuration
  </a>
  
    <nav class="md-nav" aria-label="Splunk HEC Destination Configuration">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#configure-additional-pki-trust-anchors" class="md-nav__link">
    Configure additional PKI Trust Anchors
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#configuration-of-alternate-destinations" class="md-nav__link">
    Configuration of Alternate Destinations
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#configuration-of-filtered-alternate-destinations-advanced" class="md-nav__link">
    Configuration of Filtered Alternate Destinations (Advanced)
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#creation-of-additional-splunk-hec-destinations" class="md-nav__link">
    Creation of Additional Splunk HEC Destinations
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#configuration-of-timezone-for-legacy-sources" class="md-nav__link">
    Configuration of timezone for legacy sources
  </a>
  
    <nav class="md-nav" aria-label="Configuration of timezone for legacy sources">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#change-global-default-time-zone" class="md-nav__link">
    Change Global default time zone
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#change-by-host-or-subnet-match" class="md-nav__link">
    Change by host or subnet match
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sc4s-disk-buffer-configuration" class="md-nav__link">
    SC4S Disk Buffer Configuration
  </a>
  
    <nav class="md-nav" aria-label="SC4S Disk Buffer Configuration">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#important-notes-regarding-disk-buffering" class="md-nav__link">
    Important Notes Regarding Disk Buffering:
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#disk-buffer-variables" class="md-nav__link">
    Disk Buffer Variables
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#archive-file-configuration" class="md-nav__link">
    Archive File Configuration
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#syslog-source-configuration" class="md-nav__link">
    Syslog Source Configuration
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#syslog-source-tls-certificate-configuration" class="md-nav__link">
    Syslog Source TLS Certificate Configuration
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sc4s-metadata-configuration" class="md-nav__link">
    SC4S metadata configuration
  </a>
  
    <nav class="md-nav" aria-label="SC4S metadata configuration">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#log-path-overrides-of-index-or-metadata" class="md-nav__link">
    Log Path overrides of index or metadata
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#override-index-or-metadata-based-on-host-ip-or-subnet-compliance-overrides" class="md-nav__link">
    Override index or metadata based on host, ip, or subnet (compliance overrides)
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dropping-all-data-by-ip-or-subnet" class="md-nav__link">
    Dropping all data by ip or subnet
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#fixing-overriding-the-host-field" class="md-nav__link">
    Fixing (overriding) the host field
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#splunk-connect-for-syslog-output-templates-syslog-ng-templates" class="md-nav__link">
    Splunk Connect for Syslog output templates (syslog-ng templates)
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#data-resilience-local-disk-buffer-configuration" class="md-nav__link">
    Data Resilience - Local Disk Buffer Configuration
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../architecture/" class="md-nav__link">
        Architectural Considerations
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../developing/" class="md-nav__link">
        Development
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_6" type="checkbox" id="__nav_6" >
      
      
      
      
        <label class="md-nav__link" for="__nav_6">
          Sources
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Sources" data-md-level="1">
        <label class="md-nav__title" for="__nav_6">
          <span class="md-nav__icon md-icon"></span>
          Sources
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../sources/" class="md-nav__link">
        About
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../sources/Alcatel/" class="md-nav__link">
        Alcatel
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../sources/Alsid/" class="md-nav__link">
        Alsid
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../sources/Avaya/" class="md-nav__link">
        Avaya
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../sources/Avi_Networks/" class="md-nav__link">
        Avi Networks
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../sources/Brocade/" class="md-nav__link">
        Brocade
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../sources/Checkpoint/" class="md-nav__link">
        Checkpoint
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../sources/Cisco/" class="md-nav__link">
        Cisco
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../sources/Citrix/" class="md-nav__link">
        Citrix
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../sources/CommonEventFormat/" class="md-nav__link">
        Common Event Format
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../sources/CyberArk/" class="md-nav__link">
        CyberArk
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../sources/Dell/" class="md-nav__link">
        Dell
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../sources/Dell_RSA/" class="md-nav__link">
        Dell RSA
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../sources/Dell_EMC/" class="md-nav__link">
        Dell EMC
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../sources/F5/" class="md-nav__link">
        F5
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../sources/FireEye/" class="md-nav__link">
        FireEye
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../sources/Forcepoint/" class="md-nav__link">
        Forcepoint
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../sources/Fortinet/" class="md-nav__link">
        Fortinet
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../sources/HAProxy/" class="md-nav__link">
        HAProxy
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../sources/HPe/" class="md-nav__link">
        HPe
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../sources/Imperva/" class="md-nav__link">
        Imperva
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../sources/InfoBlox/" class="md-nav__link">
        InfoBlox
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../sources/ISC/" class="md-nav__link">
        ISC
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../sources/LogExtendedEventFormat/" class="md-nav__link">
        Log Extended Format
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../sources/Juniper/" class="md-nav__link">
        Juniper
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../sources/Loggen/" class="md-nav__link">
        Loggen
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../sources/McAfee/" class="md-nav__link">
        McAfee
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../sources/Microfocus/" class="md-nav__link">
        Microfocus
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../sources/Microsoft/" class="md-nav__link">
        Microsoft
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../sources/NetApp/" class="md-nav__link">
        NetApp
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../sources/Netmotion/" class="md-nav__link">
        Netmotion
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../sources/Novell/" class="md-nav__link">
        Novell
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../sources/nix/" class="md-nav__link">
        Nix
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../sources/Ossec/" class="md-nav__link">
        OSSEC
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../sources/PaloaltoNetworks/" class="md-nav__link">
        Palo Alto Networks
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../sources/Pfsense/" class="md-nav__link">
        pfSense
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../sources/Polycom/" class="md-nav__link">
        Polycom
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../sources/Pulse/" class="md-nav__link">
        Pulse
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../sources/Proofpoint/" class="md-nav__link">
        Proofpoint
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../sources/Radware/" class="md-nav__link">
        Radware
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../sources/Ricoh/" class="md-nav__link">
        Ricoh
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../sources/Schneider/" class="md-nav__link">
        Schneider
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../sources/Simple/" class="md-nav__link">
        Simple Sources
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../sources/Sophos/" class="md-nav__link">
        Sophos
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../sources/Spectracom/" class="md-nav__link">
        Spectracom
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../sources/Splunk/" class="md-nav__link">
        Splunk
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../sources/Broadcom/" class="md-nav__link">
        Broadcom
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../sources/Tanium/" class="md-nav__link">
        Tanium
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../sources/Tenable/" class="md-nav__link">
        Tenable
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../sources/Thycotic/" class="md-nav__link">
        Thycotic
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../sources/Tintri/" class="md-nav__link">
        Tintri
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../sources/Trend/" class="md-nav__link">
        Trend
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../sources/Ubiquiti/" class="md-nav__link">
        Ubiquiti
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../sources/Vectra/" class="md-nav__link">
        Vectra
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../sources/Varonis/" class="md-nav__link">
        Varonis
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../sources/VMWare/" class="md-nav__link">
        VMware
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../sources/Wallix/" class="md-nav__link">
        Wallix
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../sources/Zscaler/" class="md-nav__link">
        Zscaler
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../performance/" class="md-nav__link">
        Performance
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_8" type="checkbox" id="__nav_8" >
      
      
      
      
        <label class="md-nav__link" for="__nav_8">
          Troubleshooting
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Troubleshooting" data-md-level="1">
        <label class="md-nav__title" for="__nav_8">
          <span class="md-nav__icon md-icon"></span>
          Troubleshooting
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../troubleshooting/troubleshoot_SC4S_server/" class="md-nav__link">
        SC4S Startup and Validation
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../troubleshooting/troubleshoot_resources/" class="md-nav__link">
        SC4S Logging and Troubleshooting Resources
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../upgrade/" class="md-nav__link">
        Upgrading SC4S
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../faq/" class="md-nav__link">
        SC4S FAQ
      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#global-configuration" class="md-nav__link">
    Global Configuration
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#configure-use-of-external-http-proxy" class="md-nav__link">
    Configure use of external http proxy
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#splunk-hec-destination-configuration" class="md-nav__link">
    Splunk HEC Destination Configuration
  </a>
  
    <nav class="md-nav" aria-label="Splunk HEC Destination Configuration">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#configure-additional-pki-trust-anchors" class="md-nav__link">
    Configure additional PKI Trust Anchors
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#configuration-of-alternate-destinations" class="md-nav__link">
    Configuration of Alternate Destinations
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#configuration-of-filtered-alternate-destinations-advanced" class="md-nav__link">
    Configuration of Filtered Alternate Destinations (Advanced)
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#creation-of-additional-splunk-hec-destinations" class="md-nav__link">
    Creation of Additional Splunk HEC Destinations
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#configuration-of-timezone-for-legacy-sources" class="md-nav__link">
    Configuration of timezone for legacy sources
  </a>
  
    <nav class="md-nav" aria-label="Configuration of timezone for legacy sources">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#change-global-default-time-zone" class="md-nav__link">
    Change Global default time zone
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#change-by-host-or-subnet-match" class="md-nav__link">
    Change by host or subnet match
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sc4s-disk-buffer-configuration" class="md-nav__link">
    SC4S Disk Buffer Configuration
  </a>
  
    <nav class="md-nav" aria-label="SC4S Disk Buffer Configuration">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#important-notes-regarding-disk-buffering" class="md-nav__link">
    Important Notes Regarding Disk Buffering:
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#disk-buffer-variables" class="md-nav__link">
    Disk Buffer Variables
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#archive-file-configuration" class="md-nav__link">
    Archive File Configuration
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#syslog-source-configuration" class="md-nav__link">
    Syslog Source Configuration
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#syslog-source-tls-certificate-configuration" class="md-nav__link">
    Syslog Source TLS Certificate Configuration
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sc4s-metadata-configuration" class="md-nav__link">
    SC4S metadata configuration
  </a>
  
    <nav class="md-nav" aria-label="SC4S metadata configuration">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#log-path-overrides-of-index-or-metadata" class="md-nav__link">
    Log Path overrides of index or metadata
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#override-index-or-metadata-based-on-host-ip-or-subnet-compliance-overrides" class="md-nav__link">
    Override index or metadata based on host, ip, or subnet (compliance overrides)
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dropping-all-data-by-ip-or-subnet" class="md-nav__link">
    Dropping all data by ip or subnet
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#fixing-overriding-the-host-field" class="md-nav__link">
    Fixing (overriding) the host field
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#splunk-connect-for-syslog-output-templates-syslog-ng-templates" class="md-nav__link">
    Splunk Connect for Syslog output templates (syslog-ng templates)
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#data-resilience-local-disk-buffer-configuration" class="md-nav__link">
    Data Resilience - Local Disk Buffer Configuration
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                
                
                <h1 id="sc4s-configuration-variables">SC4S Configuration Variables<a class="headerlink" href="#sc4s-configuration-variables" title="Permanent link">&para;</a></h1>
<p>Other than device filter creation, SC4S is almost entirely controlled by environment variables.  Here are the categories
and variables needed to properly configure SC4S for your environment.</p>
<h2 id="global-configuration">Global Configuration<a class="headerlink" href="#global-configuration" title="Permanent link">&para;</a></h2>
<table>
<thead>
<tr>
<th>Variable</th>
<th>Values</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>SC4S_DEST_SPLUNK_HEC_DEFAULT_URL</td>
<td>url</td>
<td>URL(s) of the Splunk endpoint, can be a single URL space seperated list</td>
</tr>
<tr>
<td>SC4S_DEST_SPLUNK_HEC_DEFAULT_TOKEN</td>
<td>string</td>
<td>Splunk HTTP Event Collector Token</td>
</tr>
<tr>
<td>SC4S_USE_REVERSE_DNS</td>
<td>yes or no(default)</td>
<td>use reverse DNS to identify hosts when HOST is not valid in the syslog header</td>
</tr>
<tr>
<td>SC4S_CONTAINER_HOST</td>
<td>string</td>
<td>variable passed to the container to identify the actual log host for container implementations</td>
</tr>
</tbody>
</table>
<ul>
<li>
<p>NOTE:  Do <em>not</em> configure HEC Acknowledgement when deploying the HEC token on the Splunk side; the underlying syslog-ng http
destination does not support this feature.  Moreover, HEC Ack would significantly degrade performance for streaming data such as
syslog.</p>
</li>
<li>
<p>NOTE:  Use of the <code>SC4S_USE_REVERSE_DNS</code> variable can have a significant impact on performance if the reverse DNS facility
(typically a caching nameserver) is not performant.  If you notice events being indexed far later than their actual timestamp
in the event (latency between <code>_indextime</code> and <code>_time</code>), this is the first place to check.</p>
</li>
</ul>
<h2 id="configure-use-of-external-http-proxy">Configure use of external http proxy<a class="headerlink" href="#configure-use-of-external-http-proxy" title="Permanent link">&para;</a></h2>
<p>Warning: Many http proxies are not provisioned with application traffic in mind. Ensure adequate capacity is available to avoid data
loss and or proxy outages. Note: the follow vairables are lower case</p>
<table>
<thead>
<tr>
<th>Variable</th>
<th>Values</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>http_proxy</td>
<td>undefined</td>
<td>Use libcurl format proxy string &ldquo;http://username:password@proxy.server:port&rdquo;</td>
</tr>
<tr>
<td>https_proxy</td>
<td>undefined</td>
<td>Use libcurl format proxy string &ldquo;http://username:password@proxy.server:port&rdquo;</td>
</tr>
</tbody>
</table>
<h2 id="splunk-hec-destination-configuration">Splunk HEC Destination Configuration<a class="headerlink" href="#splunk-hec-destination-configuration" title="Permanent link">&para;</a></h2>
<table>
<thead>
<tr>
<th>Variable</th>
<th>Values</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>SC4S_DEST_SPLUNK_HEC_GLOBAL</td>
<td>yes</td>
<td>Send events to Splunk using HEC.  This applies <em>only</em> to the primary HEC destination.</td>
</tr>
<tr>
<td>SC4S_DEST_SPLUNK_HEC_CIPHER_SUITE</td>
<td>comma separated list</td>
<td>Open SSL cipher suite list</td>
</tr>
<tr>
<td>SC4S_DEST_SPLUNK_HEC_SSL_VERSION</td>
<td>comma separated list</td>
<td>Open SSL version list</td>
</tr>
<tr>
<td>SC4S_DEST_SPLUNK_HEC_DEFAULT_TLS_VERIFY</td>
<td>yes(default) or no</td>
<td>verify HTTP(s) certificate</td>
</tr>
<tr>
<td>SC4S_DEST_SPLUNK_HEC_WORKERS</td>
<td>numeric</td>
<td>Number of destination workers (default: 10 threads).  This should rarely need to be changed; consult sc4s community for advice on appropriate setting in extreme high- or low-volume environments.</td>
</tr>
<tr>
<td>SC4S_DEST_SPLUNK_INDEXED_FIELDS</td>
<td>facility,<br>severity,<br>container,<br>loghost,<br>destport,<br>fromhostip,<br>proto<br><br>none</td>
<td>List of sc4s indexed fields that will be included with each event in Splunk (default is the entire list except &ldquo;none&rdquo;).  Two other indexed fields, <code>sc4s_vendor_product</code> and <code>sc4s_syslog_format</code>, will also appear along with the fields selected via the list and cannot be turned on or off individually.  If no indexed fields are desired (including the two internal ones), set the value to the single value of &ldquo;none&rdquo;.  When setting this variable, separate multiple entries with commas and do not include extra spaces.<br><br>This list maps to the following indexed fields that will appear in all Splunk events:<br>facility: sc4s_syslog_facility<br>severity: sc4s_syslog_severity<br>container: sc4s_container<br>loghost: sc4s_loghost<br>dport: sc4s_destport<br>fromhostip: sc4s_fromhostip<br>proto: sc4s_proto</td>
</tr>
</tbody>
</table>
<ul>
<li>
<p>NOTE:  When using alternate HEC destinations, the destination operating paramaters outlined above (<code>CIPHER_SUITE</code>, <code>SSL_VERSION</code>, etc.) can be
individually controlled per <code>DESTID</code> (see &ldquo;Configuration of Additional Splunk HEC Destinations&rdquo; immediately below).  For example, to set the number of workers
for the alternate HEC destination <code>d_hec_FOO</code> to 24, set <code>SC4S_DEST_SPLUNK_HEC_FOO_WORKERS=24</code>.</p>
</li>
<li>
<p>NOTE2:  Configuration files for destinations must have a <code>.conf</code> extension</p>
</li>
</ul>
<h3 id="configure-additional-pki-trust-anchors">Configure additional PKI Trust Anchors<a class="headerlink" href="#configure-additional-pki-trust-anchors" title="Permanent link">&para;</a></h3>
<p>Additional trusted (private) Certificate authorities may be trusted by appending each PEM formated certificate to <code>/opt/sc4s/tls/trusted.pem</code></p>
<h2 id="configuration-of-alternate-destinations">Configuration of Alternate Destinations<a class="headerlink" href="#configuration-of-alternate-destinations" title="Permanent link">&para;</a></h2>
<p>In addition to the standard HEC destination that is used to send events to Splunk, alternate distinations can be created and configured
in SC4S.  All alternate destinations (including alternate HEC destinations discussed below) are configured using the environment
variables below.  Global and/or source-specific forms of the variables below can be used to send data to additional and/or alternate
destinations.</p>
<ul>
<li>
<p>NOTE:  The administrator is responsible for ensuring that any non-HEC alternate destinations are configured in the
local mount tree, and that the underlying syslog-ng process in SC4S properly parses them.</p>
</li>
<li>
<p>NOTE:  Do not include the primary HEC destination (<code>d_hec</code>) in any list of alternate destinations.  The configuration of the primary HEC
destination is configured separately from that of the alternates below.  However, <em>alternate</em> HEC destinations (e.g. <code>d_hec_FOO</code>) should be
configured below, just like any other user-supplied destination.</p>
</li>
</ul>
<table>
<thead>
<tr>
<th>Variable</th>
<th>Values</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>SC4S_DEST_GLOBAL_ALTERNATES</td>
<td>Comma or space-separated list of destinations</td>
<td>Send all sources to alternate destinations</td>
</tr>
<tr>
<td>SC4S_DEST_&lt;VENDOR_PRODUCT&gt;_ALTERNATES</td>
<td>Comma or space-separated list of syslog-ng destinations</td>
<td>Send specific sources to alternate syslog-ng destinations using the VENDOR_PRODUCT syntax, e.g. <code>SC4S_DEST_CISCO_ASA_ALTERNATES</code></td>
</tr>
</tbody>
</table>
<h2 id="configuration-of-filtered-alternate-destinations-advanced">Configuration of Filtered Alternate Destinations (Advanced)<a class="headerlink" href="#configuration-of-filtered-alternate-destinations-advanced" title="Permanent link">&para;</a></h2>
<p>Though source-specific forms of the variables configured above will limit configured alternate destinations to a specifc data source, there
are cases where even more granularity is desired within a specific data source (e.g. to send all Cisco ASA &ldquo;debug&rdquo; traffic to Cisco Prime for
analysis).  This extra traffic may or may not be needed in Splunk.  To accomudate this use case, Filtered Alternate Destinations allow a
filter to be supplied to redirect a <em>portion</em> of a given source&rsquo;s traffic to a list of altnerate destinations (and, optionally, to prevent
matching events from being sent to Splunk).  Again, these are configured through environment variables similar
to the ones above:</p>
<table>
<thead>
<tr>
<th>Variable</th>
<th>Values</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>SC4S_DEST_&lt;VENDOR_PRODUCT&gt;_ALT_FILTER</td>
<td>syslog-ng filter</td>
<td>Filter to determine which events are sent to alternate destination(s)</td>
</tr>
<tr>
<td>SC4S_DEST_&lt;VENDOR_PRODUCT&gt;_FILTERED_ALTERNATES</td>
<td>Comma or space-separated list of syslog-ng destinations</td>
<td>Send filtered events to alternate syslog-ng destinations using the VENDOR_PRODUCT syntax, e.g. <code>SC4S_DEST_CISCO_ASA_FILTERED_ALTERNATES</code></td>
</tr>
</tbody>
</table>
<ul>
<li>
<p>NOTE:  This is an advanced capability, and filters and destinations using proper syslog-ng syntax must be constructed prior to utilizing
this feature.</p>
</li>
<li>
<p>NOTE:  Unlike the standard alternate destinations configured above, the regular &ldquo;mainline&rdquo; destinations (including the primary HEC
destination or configured archive destination (<code>d_hec</code> or <code>d_archive</code>)) are <em>not</em> included for events matching the configured alternate
destination filter.  If an event matches the filter, the list of filtered alternate destinations completely replaces any mainline destinations
including defaults and global or source-based standard alternate destinations.  Be sure to include them in the filtered destination list if
desired.</p>
</li>
<li>
<p>HINT:  Since the filtered alternate destinations completely replace the mainline destinations (including HEC to Splunk), a filter that
matches all traffic can be used with a destination list that does <em>not</em> include the standard HEC destination to effectively turn off HEC
for a given data source.</p>
</li>
</ul>
<h2 id="creation-of-additional-splunk-hec-destinations">Creation of Additional Splunk HEC Destinations<a class="headerlink" href="#creation-of-additional-splunk-hec-destinations" title="Permanent link">&para;</a></h2>
<p>Additional Splunk HEC destinations can be dynamically created through environment variables. When set, the destinations will be
created with the <code>DESTID</code> appended, for example: <code>d_hec_fmt_FOO</code>.  These destinations can then be specified for use (along with any other
destinations created locally) either globally or per source.  See the &ldquo;Alternate Destination Use&rdquo; in the next section for details.</p>
<table>
<thead>
<tr>
<th>Variable</th>
<th>Values</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>SPLUNK_HEC_ALT_DESTS</td>
<td>Comma or space-separated UPPER case list of destination IDs</td>
<td>Destination IDs are UPPER case, single-word friendly strings used to identify the new destinations which will be named with the <code>DESTID</code> appended, for example <code>d_hec_FOO</code></td>
</tr>
<tr>
<td>SPLUNK_HEC_&lt;DESTID&gt;_URL</td>
<td>url</td>
<td>Example: <code>SPLUNK_HEC_FOO_URL=https://splunk:8088</code>  <code>DESTID</code> must be a member of the list specified in <code>SPLUNK_HEC_ALT_DESTS</code> configured above</td>
</tr>
<tr>
<td>SPLUNK_HEC_&lt;DESTID&gt;_TOKEN</td>
<td>string</td>
<td>Example: <code>SPLUNK_HEC_BAR_TOKEN=&lt;token&gt;</code>  <code>DESTID</code> must be a member of the list specified in <code>SPLUNK_HEC_ALT_DESTS</code> configured above</td>
</tr>
</tbody>
</table>
<ul>
<li>
<p>NOTE:  The <code>DESTID</code> specified in the <code>URL</code> and <code>TOKEN</code> variables above <em>must</em> match the <code>DESTID</code> entries enumerated in the
<code>SPLUNK_HEC_ALT_DESTS</code> list. For each <code>DESTID</code> value specified in <code>SPLUNK_HEC_ALT_DESTS</code> there must be a corresponding <code>URL</code> and <code>TOKEN</code>
variable set as well. Failure to do so will cause destinations to be created without proper HEC parameters which will result in connection
failure.</p>
</li>
<li>
<p>NOTE:  Additional Splunk HEC destinations will <em>not</em> be tested at startup.  It is the responsiblity of the admin to ensure that additional destinations
are provisioned with the correct URL(s) and tokens to ensure proper connectivity.</p>
</li>
<li>
<p>NOTE: The disk and CPU requirements will increase proportionally depending on the number of additional HEC destinations in use (e.g. each HEC
destination will have its own disk buffer by default).</p>
</li>
</ul>
<h2 id="configuration-of-timezone-for-legacy-sources">Configuration of timezone for legacy sources<a class="headerlink" href="#configuration-of-timezone-for-legacy-sources" title="Permanent link">&para;</a></h2>
<p>Legacy sources (those that remain non compliant with RFC5424) often leave the recipient to
guess at the actual time zone offset. SC4S uses an advanced feature of syslog-ng to &ldquo;guess&rdquo; the correct time zone for real time sources.
However, this feature requires the source (device) clock to be synchronized to within +/- 30s of the SC4S system clock.
Industry accepted best practice is to set such legacy systems to GMT (sometimes inaccurately called UTC).
However, this is not always possible and in such cases two additional methods are available. For a list of <a href="https://en.wikipedia.org/wiki/List_of_tz_database_time_zones">time zones see</a>. Only the &ldquo;TZ Database name&rdquo; OR &ldquo;offset&rdquo; format may be used.</p>
<h3 id="change-global-default-time-zone">Change Global default time zone<a class="headerlink" href="#change-global-default-time-zone" title="Permanent link">&para;</a></h3>
<p>Set the <code>SC4S_DEFAULT_TIMEZONE</code> variable to a recognized &ldquo;zone info&rdquo; (Region/City) time zone format such as <code>America/New_York</code>.
Setting this value will force SC4S to use the specified timezone (and honor its associated Daylight Savings/Summer Time rules)
for all events without a timezone offset in the header or message payload.</p>
<h3 id="change-by-host-or-subnet-match">Change by host or subnet match<a class="headerlink" href="#change-by-host-or-subnet-match" title="Permanent link">&para;</a></h3>
<p>Using the following example &ldquo;vendor_product_by_source&rdquo; configuration as a guide, create a matching host wildcard pattern (glob)
to identify all devices in the &ldquo;east&rdquo; datacenter located in the Eastern US time zone.  Though not shown in the example, IP/CIDR
blocks and other more complex filters can also be used, but be aware of the performance implications of complex filtering.</p>
<div class="codehilite"><pre><span></span><code>#vendor_product_by_source.conf
#Note that all filter syntax options of syslog-ng are available here, but be aware that complex filtering
#can have a negative impact on performance.

filter f_tzfif_dc_us_eastxny {
    host(&quot;*-D001-*&quot; type(glob))
};

#vendor_product_by_source.csv
#Add the following line

f_dc_us_east,sc4s_time_zone,&quot;America/New_York&quot;
</code></pre></div>

<h2 id="sc4s-disk-buffer-configuration">SC4S Disk Buffer Configuration<a class="headerlink" href="#sc4s-disk-buffer-configuration" title="Permanent link">&para;</a></h2>
<p>Disk buffers in SC4S are allocated <em>per destination</em>.  Keep this in mind when using additional destinations that have disk buffering configured.  By
default, when alternate HEC destinations are configured as outlined above disk buffering will be configured identically to that of the main HEC
destination (unless overriden individually).</p>
<h3 id="important-notes-regarding-disk-buffering">Important Notes Regarding Disk Buffering:<a class="headerlink" href="#important-notes-regarding-disk-buffering" title="Permanent link">&para;</a></h3>
<ul>
<li>
<p>&ldquo;Reliable&rdquo; disk buffering offers little advantage over &ldquo;normal&rdquo; disk buffering, at a significant performance penalty.
For this reason, normal disk buffering is recommended.</p>
</li>
<li>
<p>If you add destinations locally in your configuration, pay attention to the <em>cumulative</em> buffer requirements when allocating local
disk.</p>
</li>
<li>
<p>Disk buffer storage is configured via container volumes and is persistent between restarts of the conatiner.
Be sure to account for disk space requirements on the local sc4s host when creating the container volumes in your respective
runtime environment (outlined in the &ldquo;getting started&rdquo; runtime docs). These volumes can grow significantly if there is
an extended outage to the SC4S destinations (HEC endpoints). See the &ldquo;SC4S Disk Buffer Configuration&rdquo; section on the Configruation
page for more info.</p>
</li>
<li>
<p>The values for the variables below represent the <em>total</em> sizes of the buffers for the destination.  These sizes are divded by the
number of workers (threads) when setting the actual syslog-ng buffer options, because the buffer options apply to each worker rather than the
entire destination.  Pay careful attention to this when using the &ldquo;BYOE&rdquo; version of SC4S, where direct access to the syslog-ng config files
may hide this nuance.  Lastly, be sure to factor in the syslog-ng data structure overhead (approx. 2x raw message size) when calculating the
total buffer size needed. To determine the proper size of the disk buffer, consult the &ldquo;Data Resilience&rdquo; section below.</p>
</li>
<li>
<p>When changing the disk buffering directory, the new directory must exist.  If it doesn&rsquo;t, then syslog-ng will fail to start.</p>
</li>
<li>
<p>When changing the disk buffering directory, if buffering has previously occurd on that instance, a persist file may exist which will prevent syslog-ng from changing the directory.</p>
</li>
</ul>
<h3 id="disk-buffer-variables">Disk Buffer Variables<a class="headerlink" href="#disk-buffer-variables" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>Variable</th>
<th>Values/Default</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>SC4S_DEST_SPLUNK_HEC_DISKBUFF_ENABLE</td>
<td>yes(default) or no</td>
<td>Enable local disk buffering</td>
</tr>
<tr>
<td>SC4S_DEST_SPLUNK_HEC_DISKBUFF_RELIABLE</td>
<td>yes or no(default)</td>
<td>Enable reliable/normal disk buffering (normal recommended)</td>
</tr>
<tr>
<td>SC4S_DEST_SPLUNK_HEC_DISKBUFF_MEMBUFSIZE</td>
<td>bytes (10241024)</td>
<td>Memory buffer size in bytes (used with reliable disk buffering)</td>
</tr>
<tr>
<td>SC4S_DEST_SPLUNK_HEC_DISKBUFF_MEMBUFLENGTH</td>
<td>messages (15000)</td>
<td>Memory buffer size in message count (used with normal disk buffering)</td>
</tr>
<tr>
<td>SC4S_DEST_SPLUNK_HEC_DISKBUFF_DISKBUFSIZE</td>
<td>bytes (53687091200)</td>
<td>Size of local disk buffer in bytes (default 50 GB)</td>
</tr>
<tr>
<td>SC4S_DEST_SPLUNK_HEC_DEFAULT_DISKBUFF_DIR</td>
<td>path</td>
<td>Location to store the disk buffer files.  This variable should <em>only</em> be set when using BYOE; this location is fixed when using the Container.</td>
</tr>
</tbody>
</table>
<h2 id="archive-file-configuration">Archive File Configuration<a class="headerlink" href="#archive-file-configuration" title="Permanent link">&para;</a></h2>
<p>This feature is designed to support compliance or &ldquo;diode mode&rdquo; archival of all messages. Instructions for mounting the appropriate
local directory to use this feature are included in each &ldquo;getting started&rdquo; runtime document. The files will be stored in a folder
structure at the mount point using the pattern shown in the table below depending on the value of the <code>SC4S_GLOBAL_ARCHIVE_MODE</code> variable.
All events for both modes are formatted using syslog-ng&rsquo;s EWMM template.</p>
<table>
<thead>
<tr>
<th>Variable</th>
<th>Value/Default</th>
<th>Location/Pattern</th>
</tr>
</thead>
<tbody>
<tr>
<td>SC4S_GLOBAL_ARCHIVE_MODE</td>
<td>compliance(default)</td>
<td><code>&lt;archive mount&gt;/${.splunk.sourcetype}/${HOST}/$YEAR-$MONTH-$DAY-archive.log</code></td>
</tr>
<tr>
<td>SC4S_GLOBAL_ARCHIVE_MODE</td>
<td>diode</td>
<td><code>&lt;archive mount&gt;/${YEAR}/${MONTH}/${DAY}/${fields.sc4s_vendor_product}_${YEAR}${MONTH}${DAY}${HOUR}${MIN}.log"</code></td>
</tr>
</tbody>
</table>
<p><strong>WARNING POTENTIAL OUTAGE CAUSING CONSEQUENCE</strong></p>
<p>Use the following variables to select global archiving or per-source archiving.  C4S does not prune the files that are created;
therefore the administrator must provide a means of log rotation to prune files and/or move them to an archival system to avoid exhaustion of disk space.</p>
<table>
<thead>
<tr>
<th>Variable</th>
<th>Values</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>SC4S_ARCHIVE_GLOBAL</td>
<td>yes or undefined</td>
<td>Enable archive of all vendor_products</td>
</tr>
<tr>
<td>SC4S_ARCHIVE_&lt;VENDOR_PRODUCT&gt;</td>
<td>yes(default) or undefined</td>
<td>See sources section of documentation enables selective archival</td>
</tr>
</tbody>
</table>
<h2 id="syslog-source-configuration">Syslog Source Configuration<a class="headerlink" href="#syslog-source-configuration" title="Permanent link">&para;</a></h2>
<table>
<thead>
<tr>
<th>Variable</th>
<th>Values/Default</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>SC4S_SOURCE_TLS_ENABLE</td>
<td>yes or no(default)</td>
<td>Enable TLS globally.  Be sure to configure the cert as shown immediately below.</td>
</tr>
<tr>
<td>SC4S_LISTEN_DEFAULT_TLS_PORT</td>
<td>undefined or 6514</td>
<td>Enable a TLS listener on port 6514</td>
</tr>
<tr>
<td>SC4S_LISTEN_DEFAULT_RFC6425_PORT</td>
<td>undefined or 5425</td>
<td>Enable a TLS listener on port 5425</td>
</tr>
<tr>
<td>SC4S_SOURCE_TLS_OPTIONS</td>
<td><code>no-sslv2</code></td>
<td>Comma-separated list of the following options: <code>no-sslv2, no-sslv3, no-tlsv1, no-tlsv11, no-tlsv12, none</code>.  See syslog-ng docs for the latest list and defaults</td>
</tr>
<tr>
<td>SC4S_SOURCE_TLS_CIPHER_SUITE</td>
<td>See openssl</td>
<td>Colon-delimited list of ciphers to support, e.g. <code>ECDHE-RSA-AES256-GCM-SHA384:ECDHE-ECDSA-AES256-GCM-SHA384</code>.  See openssl docs for the latest list and defaults</td>
</tr>
<tr>
<td>SC4S_SOURCE_TCP_MAX_CONNECTIONS</td>
<td>2000</td>
<td>Max number of TCP Connections</td>
</tr>
<tr>
<td>SC4S_SOURCE_TCP_IW_SIZE</td>
<td>20000000</td>
<td>Initial Window size</td>
</tr>
<tr>
<td>SC4S_SOURCE_TCP_FETCH_LIMIT</td>
<td>2000</td>
<td>Number of events to fetch from server buffer at once</td>
</tr>
<tr>
<td>SC4S_SOURCE_UDP_SO_RCVBUFF</td>
<td>17039360</td>
<td>UDP server buffer size in bytes. Make sure that the host OS kernel is configured <a href="../gettingstarted/#prerequisites">similarly</a>.</td>
</tr>
<tr>
<td>SC4S_SOURCE_LISTEN_UDP_SOCKETS</td>
<td>1</td>
<td>Number of kernel sockets per active UDP port, which configures multi-threading of the UDP input buffer in the kernel to prevent packet loss.  Total UDP input buffer is the multiple of SC4S_SOURCE_LISTEN_UDP_SOCKETS * SC4S_SOURCE_UDP_SO_RCVBUFF</td>
</tr>
<tr>
<td>SC4S_SOURCE_STORE_RAWMSG</td>
<td>undefined or &ldquo;no&rdquo;</td>
<td>Store unprocessed &ldquo;on the wire&rdquo; raw message in the RAWMSG macro for use with the &ldquo;fallback&rdquo; sourcetype.  Do <em>not</em> set this in production; substantial memory and disk overhead will result. Use for log path/filter development only.</td>
</tr>
<tr>
<td>SC4S_IPV6_ENABLE</td>
<td>yes or no(default)</td>
<td>enable (dual-stack)IPv6 listeners and health checks</td>
</tr>
</tbody>
</table>
<h2 id="syslog-source-tls-certificate-configuration">Syslog Source TLS Certificate Configuration<a class="headerlink" href="#syslog-source-tls-certificate-configuration" title="Permanent link">&para;</a></h2>
<ul>
<li>Create a folder <code>/opt/sc4s/tls</code> if not already done as part of the &ldquo;getting started&rdquo; process.</li>
<li>Uncomment the appropriate mount line in the unit or yaml file (again, documented in the &ldquo;getting started&rdquo; runtime documents).</li>
<li>Save the server private key in PEM format with NO PASSWORD to <code>/opt/sc4s/tls/server.key</code></li>
<li>Save the server certificate in PEM format to <code>/opt/sc4s/tls/server.pem</code></li>
<li>Ensure the entry <code>SC4S_SOURCE_TLS_ENABLE=yes</code> exists in <code>/opt/sc4s/env_file</code></li>
</ul>
<h2 id="sc4s-metadata-configuration">SC4S metadata configuration<a class="headerlink" href="#sc4s-metadata-configuration" title="Permanent link">&para;</a></h2>
<h3 id="log-path-overrides-of-index-or-metadata">Log Path overrides of index or metadata<a class="headerlink" href="#log-path-overrides-of-index-or-metadata" title="Permanent link">&para;</a></h3>
<p>A key aspect of SC4S is to properly set Splunk metadata prior to the data arriving in Splunk (and before any TA processing 
takes place).  The filters will apply the proper index, source, sourcetype, host, and timestamp metadata automatically by
individual data source.  Proper values for this metadata, including a recommended index and output format (template), are
included with all &ldquo;out-of-the-box&rdquo; log paths included with SC4S and are chosen to properly interface with the corresponding
TA in Splunk.  The administrator will need to ensure all recommneded indexes be created to accept this data if the defaults
are not changed.</p>
<p>It will be common to override default values in many installations. To accomodate this, each log path consults
an internal lookup file that maps Splunk metadata to the specific data source being processed.  This file contains the
defaults that are used by SC4S to set the appropriate Splunk metadata (<code>index</code>, <code>host</code>, <code>source</code>, and <code>sourcetype</code>) for each
data source.  This file is not directly available to the administrator, but a copy of the file is deposited in the local mouunted directory
(by default <code>/opt/sc4s/local/context/splunk_metadata.csv.example</code>) for reference.  It is important to note that this copy is <em>not</em> used
directly, but is provided solely for reference.  To add to the list, or to override default entries, simply create an override file without
the <code>example</code> extension (e.g. <code>/opt/sc4s/local/context/splunk_metadata.csv</code>) and modify it according to the instructions below.</p>
<p><code>splunk_metadata.csv</code> is a CSV
file containing a &ldquo;key&rdquo; that is referenced in the log path for each data source.  These keys are documented in the individual
source files in this section, and allow one to override Splunk metadata either in whole or part. The use of this file is best
shown by example.  Here is the Netscreen &ldquo;Sourcetype and Index Configuration&rdquo; table from the Juniper
<a href="../sources/Juniper/">source documentation</a>:</p>
<table>
<thead>
<tr>
<th>key</th>
<th>sourcetype</th>
<th>index</th>
<th>notes</th>
</tr>
</thead>
<tbody>
<tr>
<td>juniper_netscreen</td>
<td>netscreen:firewall</td>
<td>netfw</td>
<td>none</td>
</tr>
</tbody>
</table>
<p>Here is a line from a typical <code>splunk_metadata.csv</code> override file:</p>
<div class="codehilite"><pre><span></span><code>juniper_netscreen,index,ns_index
</code></pre></div>

<p>The columns in this file are <code>key</code>, <code>metadata</code>, and <code>value</code>.  To make a change via the override file, consult the <code>example</code> file (or
the source documentation) for the proper key when overrdiing an existing source and modify and/or add rows in the table, specifying one or
more of the following <code>metadata/value</code> pairs for a given <code>key</code>:</p>
<ul>
<li><code>key</code> which refers to the vendor and product name of the data source, using the <code>vendor_product</code> convention.  For overrides, these keys
   will be listed in the <code>example</code> file.  For new (custom) sources, be sure to choose a key that accurately reflects the vendor and product
   being configured, and that matches what is specified in the log path.</li>
<li><code>index</code> to specify an alternate <code>value</code> for index</li>
<li><code>source</code> to specify an alternate <code>value</code> for source</li>
<li><code>host</code> to specify an alternate <code>value</code> for host</li>
<li><code>sourcetype</code> to specify an alternate <code>value</code> for sourcetype (be <em>very</em> careful when changing this; only do so if an upstream
    TA is <em>not</em> being used, or a custom TA (built by you) is being used.)</li>
<li><code>sc4s_template</code> to specify an alternate <code>value</code> for the syslog-ng template that will be used to format the event that will be
   indexed by Splunk.  Changing this carries the same warning as the sourcetype above; this will affect the upstream TA.  The template
   choices are documented <a href="./#splunk-connect-for-syslog-output-templates-syslog-ng-templates">elsewhere</a> in this Configuration section.</li>
</ul>
<p>In our example above, the <code>juniper_netscreen</code> key references a new index used for that data source called <code>ns_index</code>.</p>
<p>In general, for most deployments the index should be the only change needed; other default metadata should almost
never be overridden (particularly for the &ldquo;Out of the Box&rdquo; data sources).  Even then, care should be taken when considering any alternates,
as the defaults for SC4S were chosen with best practices in mind.</p>
<ul>
<li>
<p>NOTE:  The <code>splunk_metadata.csv</code> file is a true override file and the entire <code>example</code> file should not be copied over to the
override.  In most cases, the override file is just one or two lines, unless an entire index category (e.g. <code>netfw</code>) needs to be overridden.
This is similar in concept to the &ldquo;default&rdquo; and &ldquo;local&rdquo; conf file precedence in Splunk Enterprise.</p>
</li>
<li>
<p>NOTE The <code>splunk_metadata.csv</code> file should always be appended with an appropriate new key and default for the index when building a custom
SC4S log path, as the new key will not exist in the internal lookup (nor the <code>example</code> file).  Care should be taken during log path design to
choose appropriate index, sourctype and template defaults so that admins are not compelled to override them.  If the custom log path is later
added to the list of SC4S-supported sources, this addendum can be removed.</p>
</li>
<li>
<p>NOTE:  As noted above, the <code>splunk_metadata.csv.example</code> file is provided for reference only and is not used directly by SC4S.  However,
it is an exact copy of the internal file, and can therefore change from release to release.  Be sure to check the example file first to make
sure the keys for any overrides map correctly to the ones in the example file.</p>
</li>
</ul>
<h3 id="override-index-or-metadata-based-on-host-ip-or-subnet-compliance-overrides">Override index or metadata based on host, ip, or subnet (compliance overrides)<a class="headerlink" href="#override-index-or-metadata-based-on-host-ip-or-subnet-compliance-overrides" title="Permanent link">&para;</a></h3>
<p>In other cases it is appropriate to provide the same overrides but based on PCI scope, geography, or other criterion rather than globally.
This is accomplished by the use of a file that uniquely identifies these source exceptions via syslog-ng filters,
which maps to an associated lookup of alternate indexes, sources, or other metadata.  In addition, (indexed) fields can also be
added to futher classify the data.</p>
<ul>
<li>
<p>The <code>conf</code> and <code>csv</code> files referenced below will be populated into the <code>/opt/sc4s/local/context</code> directory when SC4S is run for the first
time after being set up according to the &ldquo;getting started&rdquo; runtime documents, in a similar fashion to <code>splunk_metadata.csv</code>.
After this first-time population of the files takes place, they can be edited (and SC4S restarted) for the changes to take effect.  To get started:</p>
</li>
<li>
<p>Edit the file <code>compliance_meta_by_source.conf</code> to supply uniquely named filters to identify events subject to override.</p>
</li>
<li>Edit the file <code>compliance_meta_by_source.csv</code> to supply appropriate field(s) and values.</li>
</ul>
<p>The three columns in the <code>csv</code> file are <code>filter name</code>, <code>field name</code>, and <code>value</code>.  Filter names in the <code>conf</code> file must match one or more
corresonding <code>filter name</code> rows in the <code>csv</code> file.  The <code>field name</code> column obeys the following convention:</p>
<ul>
<li><code>.splunk.index</code> to specify an alternate <code>value</code> for index</li>
<li><code>.splunk.source</code> to specify an alternate <code>value</code> for source</li>
<li><code>.splunk.sourcetype</code> to specify an alternate <code>value</code> for sourcetype (be <em>very</em> careful when changing this; only do so if a downstream
    TA is <em>not</em> being used, or a custom TA (built by you) is being used.)</li>
<li><code>fields.fieldname</code> where <code>fieldname</code> will become the name of an indexed field sent to Splunk with the supplied <code>value</code>    </li>
</ul>
<p>This file construct is best shown by an example.  Here is a sample <code>compliance_meta_by_source.conf</code> file:</p>
<div class="codehilite"><pre><span></span><code>filter f_test_test {
   host(&quot;something-*&quot; type(glob)) or
   netmask(192.168.100.1/24)
};
</code></pre></div>

<p>and the corresponding <code>compliance_meta_by_source.csv</code> file:</p>
<div class="codehilite"><pre><span></span><code>f_test_test,.splunk.index,&quot;pciindex&quot;
f_test_test,fields.compliance,&quot;pci&quot;
</code></pre></div>

<p>First off, ensure that the filter name(s) in the <code>conf</code> file match
one or more rows in the <code>csv</code> file. In this case, any incoming message with a hostname starting with <code>something-</code> or arriving from a netmask
of <code>192.168.100.1/24</code> will match the <code>f_test_test</code> filter, and the corresponding entries in the <code>csv</code> file will be checked for overrides.
In this case, the new index is <code>pciindex</code>, and an indexed field named <code>compliance</code> will be sent to Splunk, with it&rsquo;s value set to <code>pci</code>.
To add additional overrides, simply add another <code>filter foo_bar {};</code> stanza to the <code>conf</code> file, and add appropriate entries to the <code>csv</code> file
that match the filter name(s) to the overrides you deisre.</p>
<ul>
<li>IMPORTANT:  The files above are actual syslog-ng config file snippets that get parsed directly by the underlying syslog-ng
process.  Take care that your syntax is correct; for more information on proper syslog-ng syntax, see the syslog-ng
<a href="https://www.syslog-ng.com/technical-documents/doc/syslog-ng-open-source-edition/3.24/administration-guide/57#TOPIC-1298086">documentation</a>.
A syntax error will cause the runtime process to abort in the &ldquo;preflight&rdquo; phase at startup.</li>
</ul>
<p>Finally, to update your changes for the systemd-based runtimes, restart SC4S using the commands:</p>
<div class="codehilite"><pre><span></span><code><span class="n">sudo</span> <span class="n">systemctl</span> <span class="n">daemon</span><span class="o">-</span><span class="n">reload</span>
<span class="n">sudo</span> <span class="n">systemctl</span> <span class="n">restart</span> <span class="n">sc4s</span>
</code></pre></div>

<p>For the Docker Swarm runtime, redeploy the updated service using the command:</p>
<div class="codehilite"><pre><span></span><code>docker stack deploy --compose-file docker-compose.yml sc4s
</code></pre></div>

<h2 id="dropping-all-data-by-ip-or-subnet">Dropping all data by ip or subnet<a class="headerlink" href="#dropping-all-data-by-ip-or-subnet" title="Permanent link">&para;</a></h2>
<p>In some cases rogue or port-probing data can be sent to SC4S from misconfigured devices or vulnerability scanners. Update
the <code>vendor_product_by_source.conf</code> filter <code>f_null_queue</code> with one or more ip/subnet masks to drop events without
logging. Note that drop metrics will be recorded.</p>
<h2 id="fixing-overriding-the-host-field">Fixing (overriding) the host field<a class="headerlink" href="#fixing-overriding-the-host-field" title="Permanent link">&para;</a></h2>
<p>In some cases the host value is not present in an event (or an IP address is in its place).  For administrators
who require a true hostname be attached to each event, SC4S provides an optional facilty to perform a reverse IP to
name lookup. If the variable <code>SC4S_USE_REVERSE_DNS</code> is set to &ldquo;yes&rdquo;, SC4S
will first check <code>host.csv</code> and replace the value of <code>host</code> with the value specified that matches the incoming IP address.
If a value is not found in <code>host.csv</code> then a reverse DNS lookup will be attempted against the configured nameserver.
The IP address will only be used as the host value as a last resort.</p>
<ul>
<li>NOTE:  Use of this variable can have a significant impact on performance if the reverse DNS facility (typically a caching
nameserver) is not performant.  If you notice events being indexed far later than their actual timestamp in the event (latency
between <code>_indextime</code> and <code>_time</code>), this is the first place to check.</li>
</ul>
<h2 id="splunk-connect-for-syslog-output-templates-syslog-ng-templates">Splunk Connect for Syslog output templates (syslog-ng templates)<a class="headerlink" href="#splunk-connect-for-syslog-output-templates-syslog-ng-templates" title="Permanent link">&para;</a></h2>
<p>Splunk Connect for Syslog utilizes the syslog-ng template mechanism to format the output payload (event) that will be sent to Splunk.
These templates can format the messages in a number of ways (straight text, JSON, etc.) as well as utilize the many syslog-ng
&ldquo;macros&rdquo; (fields) to specify what gets placed in the payload that is delivered to the destination.  Here is a list of the templates
used in SC4S, which can be used in the metadata override section immediately above.  New templates can also be added by the
administrator in the &ldquo;local&rdquo; section for local destinations; pay careful attention to the syntax as the templates are &ldquo;live&rdquo;
syslog-ng config code.</p>
<table>
<thead>
<tr>
<th>Template name</th>
<th>Template contents</th>
<th>Notes</th>
</tr>
</thead>
<tbody>
<tr>
<td>t_standard</td>
<td>${DATE} ${HOST} ${MSGHDR}${MESSAGE}</td>
<td>Standard template for most RFC3164 (standard syslog) traffic</td>
</tr>
<tr>
<td>t_msg_only</td>
<td>${MSGONLY}</td>
<td>syslog-ng $MSG is sent, no headers (host, timestamp, etc.)</td>
</tr>
<tr>
<td>t_msg_trim</td>
<td>$(strip $MSGONLY)</td>
<td>As above with whitespace stripped</td>
</tr>
<tr>
<td>t_everything</td>
<td>${ISODATE} ${HOST} ${MSGHDR}${MESSAGE}</td>
<td>Standard template with ISO date format</td>
</tr>
<tr>
<td>t_hdr_msg</td>
<td>${MSGHDR}${MESSAGE}</td>
<td>Useful for non-compliant syslog messages</td>
</tr>
<tr>
<td>t_legacy_hdr_msg</td>
<td>${LEGACY_MSGHDR}${MESSAGE}</td>
<td>Useful for non-compliant syslog messages</td>
</tr>
<tr>
<td>t_hdr_sdata_msg</td>
<td>${MSGHDR}${MSGID} ${SDATA} ${MESSAGE}</td>
<td>Useful for non-compliant syslog messages</td>
</tr>
<tr>
<td>t_program_msg</td>
<td>${PROGRAM}[${PID}]: ${MESSAGE}</td>
<td>Useful for non-compliant syslog messages</td>
</tr>
<tr>
<td>t_program_nopid_msg</td>
<td>${PROGRAM}: ${MESSAGE}</td>
<td>Useful for non-compliant syslog messages</td>
</tr>
<tr>
<td>t_JSON_3164</td>
<td>$(format-json &ndash;scope rfc3164<br>&ndash;pair PRI=&rdquo;&lt;$PRI&gt;&rdquo;<br>&ndash;key LEGACY_MSGHDR<br>&ndash;exclude FACILITY<br>&ndash;exclude PRIORITY)</td>
<td>JSON output of all RFC3164-based syslog-ng macros.  Useful with the &ldquo;fallback&rdquo; sourcetype to aid in new filter development.</td>
</tr>
<tr>
<td>t_JSON_5424</td>
<td>$(format-json &ndash;scope rfc5424<br>&ndash;pair PRI=&rdquo;&lt;$PRI&gt;&rdquo;<br>&ndash;key ISODATE<br>&ndash;exclude DATE<br>&ndash;exclude FACILITY<br>&ndash;exclude PRIORITY)</td>
<td>JSON output of all RFC5424-based syslog-ng macros; for use with RFC5424-compliant traffic.</td>
</tr>
<tr>
<td>t_JSON_5424_SDATA</td>
<td>$(format-json &ndash;scope rfc5424<br>&ndash;pair PRI=&rdquo;&lt;$PRI&gt;&rdquo;<br>&ndash;key ISODATE<br>&ndash;exclude DATE<br>&ndash;exclude FACILITY<br>&ndash;exclude PRIORITY)<br>&ndash;exclude MESSAGE</td>
<td>JSON output of all RFC5424-based syslog-ng macros except for MESSAGE; for use with RFC5424-compliant traffic.</td>
</tr>
</tbody>
</table>
<h2 id="data-resilience-local-disk-buffer-configuration">Data Resilience - Local Disk Buffer Configuration<a class="headerlink" href="#data-resilience-local-disk-buffer-configuration" title="Permanent link">&para;</a></h2>
<p>SC4S provides capability to minimize the number of lost events if the connection to all the Splunk Indexers goes down. 
This capability utilizes the disk buffering feature of Syslog-ng. SC4S receives a response from the Splunk HTTP Event
Collector (HEC) when a message is received successfully. If a confirmation message from the HEC endpoint is not
received (or a server busy reply, such as a 503 is sent), the load balancer will try the next HEC endpoint in the pool.
If all pool members are exhausted (such as would occur if there were a full network outage to the HEC endpoints), events
will queue to the local disk buffer on the SC4S Linux host. SC4S will continue attempting to send the failed
events while it buffers all new incoming events to disk. If the disk space allocated to disk buffering fills up then SC4S
will stop accepting new events and subsequent events will be lost. Once SC4S gets confirmation that events are again being
received by one or more indexers, events will then stream from the buffer using FIFO queueing. The number of
events in the disk buffer will reduce as long as the incoming event volume is less than the maximum SC4S (with the disk
buffer in the path) can handle. When all events have been emptied from the disk buffer, SC4S will resume streaming events
directly to Splunk.</p>
<p>For more detail on the Syslog-ng behavior the documentation can be found here:
https://www.syslog-ng.com/technical-documents/doc/syslog-ng-open-source-edition/3.22/administration-guide/55#TOPIC-1209280</p>
<p>SC4S has disk buffering enabled by default and it is strongly recommended that you keep it on, however this feature does
have a performance cost.
Without disk buffering enabled SC4S can handle up to 345K EPS (800 bytes/event avg)
With Normal disk buffering enabled SC4S can handle up to 60K EPS (800 bytes/event avg) &ndash; This is still a lot of data!</p>
<p>To guard against data loss it is important to configure the appropriate type and amount of storage for SC4S disk buffering.
To estimate the storage allocation, follow these steps:</p>
<ul>
<li>Start with your estimated maximum events per second that each SC4S server will experience. Based on the maximum
throughput of SC4S with disk buffering enabled, the conservative estimate for maximum events per second would be 60K
(however, you should use the maximum rate in your environment for this calculation, not the max rate SC4S can handle). </li>
<li>Next is your average estimated event size based on your data sources. It is common industry practice to estimate log
events as 800 bytes on average. </li>
<li>Then, factor in the maximum length of connectivity downtime you want disk buffering to be able to handle. This measure
is very much dependent on your risk tolerance.</li>
<li>Lastly, syslog-ng imposes significant overhead to maintain its internal data structures (primarily macros) so that the
data can be properly &ldquo;played back&rdquo; upon network restoration.  This overhead currently runs at about 1.7x above the total
storage size for the raw messages themselves, and can be higher for &ldquo;fallback&rdquo; data sources due to the overlap of syslog-ng
macros (data fields) containing some or all of the original message.</li>
</ul>
<p>For example, to protect against a full day of lost connectivity from SC4S to all your indexers at maximum throughput the
calculation would look like the following:</p>
<p>60,000 EPS * 86400 seconds * 800 bytes * 1.7 = 6.4 TB of storage</p>
<p>To configure storage allocation for the SC4S disk buffering, do the following:</p>
<ul>
<li>Edit the file /opt/sc4s/default/env_file</li>
<li>Add the SC4S_DEST_SPLUNK_HEC_DISKBUFF_DISKBUFSIZE variable to the file and set the value to the number of bytes based
on your estimation (e.g. 7050240000000 in the example above)</li>
<li>Splunk does not recommend reducing the disk allocation below 500 GB</li>
<li>Restart SC4S</li>
</ul>
<p>Given that in a connectivity outage to the Indexers events will be saved and read from disk until the buffer is emptied,
it is ideal to use the fastest type of storage available. For this reason, NVMe storage is recommended for SC4S disk buffering.</p>
<p>It is best to design your deployment so that the disk buffer will drain after connectivity is restored to the Splunk Indexers
(while incoming data continues at the same general rate).  Since &ldquo;your mileage may vary&rdquo; with different combinations of
data load, instance type, and disk subsystem performance, it is good practice to provision a box that performs twice as
well as is required for your max EPS. This headroom will allow for rapid recovery after a connectivity outage.</p>
                
              
              
                


              
            </article>
          </div>
        </div>
        
      </main>
      
        
<footer class="md-footer">
  
    <nav class="md-footer__inner md-grid" aria-label="Footer">
      
        
        <a href="../gettingstarted/quickstart_guide/" class="md-footer__link md-footer__link--prev" aria-label="Previous: Quickstart Guide" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              Quickstart Guide
            </div>
          </div>
        </a>
      
      
        
        <a href="../architecture/" class="md-footer__link md-footer__link--next" aria-label="Next: Architectural Considerations" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              Architectural Considerations
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        
          Made with
          <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
            Material for MkDocs
          </a>
        
        
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "..", "features": [], "translations": {"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing", "select.version.title": "Select version"}, "search": "../assets/javascripts/workers/search.f8263e09.min.js", "version": {"provider": "mike"}}</script>
    
    
      <script src="../assets/javascripts/bundle.4fc53ad4.min.js"></script>
      
    
  </body>
</html>