block parser app-cef-opswat-mscl() {
    channel {
        rewrite {
            r_set_splunk_dest_default(
                index('netwaf'),
                vendor('opswat'),
                product('${.metadata.cef.device_product}'),
                source('opswat:$(lowercase ${.metadata.cef.device_product})'),
                sourcetype('opswat:$(lowercase ${.metadata.cef.device_product}):cef')
            );
        };
    };
};

application app-cef-opswat-mscl[cef] {
    filter{
        match("OPSWAT" value(".metadata.cef.device_vendor"))
        and ( 
            match("MSCL" value(".metadata.cef.device_product"))
            or match("MSCW" value(".metadata.cef.device_product"))
            or match("ICAP" value(".metadata.cef.device_product"))
        );
    };
    parser { app-cef-opswat-mscl(); };
};
