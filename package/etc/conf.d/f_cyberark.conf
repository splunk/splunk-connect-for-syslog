# ===============================================================================================
# Cisco IOS (Route/Switch)
# ===============================================================================================

log {
# ===============================================================================================
# Section 1:  source configuration
# Defaults: default source and ports as defined in s_sources.conf and syslog-ng.conf.
#
# IMPORTANT:  In order to ensure proper startup, select only one source in this section.
# If a source other than the default is used, ensure that any UDP/TCP protocol/port pairs passed
# are unique throughout the *entire* sylog-ng config.  If there are any port overlaps with those
# in source declarations from other filter files, an "Address already in use" error will occur
# at startup.
# ===============================================================================================

# source(s_default-ports);

source { s_unique-ports(udp_port(5514) tcp_port(5514)); };

# ===============================================================================================
# Section 2:  parser configuration
# Default syslog-parser() should work for most messages
# ===============================================================================================

# This is "normal" RFC3164-formatted (BSD-syslog) messages. Always try this one first if unsure.
# parser { syslog-parser(time-zone(`default-timezone`)); };
# parser { cisco-parser(); };

# For RFC5424-formatted messages, use this instead
# parser { syslog-parser(time-zone(`default-timezone`) flags(syslog-protocol)); };
  parser { p_RFC5424-lite(); };

# ===============================================================================================
# Section 3:  filter configuration
# Filter below may be omitted in the log path if a dedicated source is configured above
# ===============================================================================================

#filter { match("[%|#][A-Z0-9_]+-[A-Z012_]*-*[0-7]-[A-Z0-9_]+:" value("MESSAGE"))
#      ;};

# ===============================================================================================
# Section 4:  destination configuration
# Select the desired destination to use in the log path from the three choices below,
# based on the transfer method (UF/HEC/Kafka) desired. Then, using the rewrite rule below,
# provide the sourcetype and optional index (if different from the default) for thie data
# source. Then, uncomment the second rewrite declartion to add any additional indexed fields
# desired.
# ===============================================================================================

#   rewrite { r_set_splunk(vendor("cyberark") template("t_hdr_msg"))}; #--UF--
#   destination(d_splunk_logfile);  #--UF--
    rewrite { r_set_splunk(sourcetype("cyberark") template("t_hdr_msg")) }; #--HEC--
    destination(d_hec);  #--HEC--
#   rewrite { r_set_splunk(sourcetype("cyberark") template("t_hdr_msg")) }; #--KAFKA--
#   destination(d_kafka);  #--KAFKA--

flags(final);
};
