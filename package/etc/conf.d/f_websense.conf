# ===============================================================================================
# Websense
# ===============================================================================================

log {
# ===============================================================================================
# Section 1:  source configuration
# Defaults: default source and ports as defined in s_sources.conf and syslog-ng.conf.
#
# IMPORTANT:  In order to ensure proper startup, select only one source in this section.
# If a source other than the default is used, ensure that any UDP/TCP protocol/port pairs passed
# are unique throughout the *entire* sylog-ng config.  If there are any port overlaps with those 
# in source declarations from other filter files, an "Address already in use" error will occur 
# at startup.
# ===============================================================================================

source (s_default-ports);     # The default port is common in many installations

# The source block (function) call below can be used to specify unique listening ports for this 
# device type

# source { s_unique-ports(udp_port(714) tcp_port(714)); };  

# ===============================================================================================
# Section 2:  parser configuration
# Default syslog-parser() should work for most messages
# ===============================================================================================

# This is "normal" RFC3164-formatted (BSD-syslog) messages. Always try this one first if unsure.
# parser { syslog-parser(); };

# For RFC5424-formatted messages, use this instead
# parser { syslog-parser(flags(syslog-protocol)); };

# For Websense
parser { p_websense-parser(); };

# ===============================================================================================
# Section 3:  filter configuration
# Filter below may be omitted in the log path if a dedicated source is configured above
# ===============================================================================================

filter { program(Websense); };

# ===============================================================================================
# Section 4:  destination configuration
# Select the desired destination to use in the log path from the three choices below,
# based on the transfer method (UF/HEC/Kafka) desired. Then, using the rewrite rule below,
# provide the sourcetype and optional index (if different from the default) for thie data
# source. Then, uncomment the second rewrite declartion to add any additional indexed fields
# desired.
# ===============================================================================================

#   rewrite { r_set_splunk(vendor("websense"))}; #--UF--
#   destination(d_splunk_logfile);  #--UF--
    rewrite { r_set_splunk(sourcetype("websense:cg:kv") template("t_everything")) }; #--HEC--
    destination(d_hec);  #--HEC--
#   rewrite { r_set_splunk(sourcetype("websense:cg:kv") template("t_everything")) }; #--KAFKA--
#   destination(d_kafka);  #--KAFKA--

flags(final);
};
