block parser syslog_ng_err-parser() {    
 channel {
        rewrite {
            r_set_splunk_dest_default(
                index("main")
                sourcetype('sc4s:fallback')
                vendor_product("sc4s_fallback")
            );            
        };       
        rewrite {r_set_destinations(group("SYSLOGNG_ERROR"))};        
        parser {p_add_context_splunk(key("${fields.sc4s_vendor_product}")); };


   };
};
application syslog_ng_err[syslog] {
	filter { 
        program('syslog-ng' type(string) flags(prefix))
        and message('Error processing log message: ' type(string) flags(prefix));
    };	
    parser { syslog_ng_err-parser(); };   
};
