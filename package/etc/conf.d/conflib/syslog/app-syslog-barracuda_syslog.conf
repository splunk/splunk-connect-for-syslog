block parser app-syslog-barracuda_syslog() {
 channel {
        rewrite {
            r_set_splunk_dest_default(
                index("netfw")
                sourcetype('barracuda')
                vendor("barracuda")
                product("waf")
                template("t_msg_only")
            );
        };
        parser {
            kv-parser(
                prefix(".values.")
                pair-separator(" ")
            );
        };
         if {
            filter {
                "${.values.logType}" eq "WF";
            };
            rewrite {
                r_set_splunk_dest_update_v2(
                    sourcetype('barracuda:web:firewall')
                    class('waf')
                );
            };
        };
   };
};
application app-syslog-barracuda_syslog[sc4s-syslog-pgm] {
	filter {
        program('Barracuda' type(string))
        ;
    };
    parser { app-syslog-barracuda_syslog(); };
};