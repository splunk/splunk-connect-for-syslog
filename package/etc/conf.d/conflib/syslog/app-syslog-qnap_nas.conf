block parser qnap_nas-parser() {
    channel {
        rewrite {
            r_set_splunk_dest_default(
                index('infraops')
                source("program:qulogd")
                sourcetype('qnap:syslog')
                vendor('qnap')
                product('nas')
                template('t_standard')
            );
        };
   };
};

application qnap_nas[sc4s-syslog-pgm] {
    filter {
        program('qulogd' type(string) flags(prefix));
    };
    parser { qnap_nas-parser(); };
};
