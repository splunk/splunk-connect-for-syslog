block parser app-syslog-hpe_procurve_fmt1() {    
 channel {
        filter { 
            "$PROGRAM" eq ""
        };	
        parser { 
            regexp-parser(
                prefix(".tmp.")
                patterns('^%%\d\d[A-Z]+\/\d\/(?<category>[A-Z_-]+)\(\w\):\s')
            );
        };
        rewrite {
            r_set_splunk_dest_default(
                index("netops")
                source('hpe:procurve:$(lowercase ${.tmp.category})')
                sourcetype('hpe:procurve')
                vendor_product("hpe_procurve")
            );
            groupunset(values('.tmp.*'));
        };        

   };
};
application app-syslog-hpe_procurve_fmt1[sc4s-syslog] {
	parser { app-syslog-hpe_procurve_fmt1(); };    
};