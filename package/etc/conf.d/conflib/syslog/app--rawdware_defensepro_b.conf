block parser radware_defensepro_b-parser() {    
 channel {
        #
        filter { 
            message('^(\[Device: ([^ ]+) [^\]]+] M_\d+: .*)', flags(store-matches));
        };   
        
        rewrite {
            r_set_splunk_dest_default(
                index('netops')
                sourcetype('radware:defensepro')
                vendor_product("radware_defensepro")
            );              
            set("$2", value('HOST'));
            set("radware_defensepro", value("fields.sc4s_syslog_format"));
        };   


   };
};
application radware_defensepro_b[sc4s-syslog] {
	parser { radware_defensepro_b-parser(); };   
};



