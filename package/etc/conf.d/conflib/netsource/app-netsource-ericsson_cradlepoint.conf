#<14>ï»¿20250428T124012-0400 (0138-CP-L950-01) WAN:3bfbb2d2: The cell id for the Internal C7A (SIM1) on port int1 is blank
block parser app-netsource-ericsson_cradlepoint() {
    channel {
        rewrite {
            r_set_splunk_dest_default(
                index('netops')
                sourcetype('ericsson:cradlepoint')
                vendor('ericsson')
                product('cradlepoint')
            );
        };

        parser {
            regexp-parser(
                prefix(".tmp.")
                patterns('(?<timestamp>\d{8}T?\d{6}[+-]\d{4})\s\((?<host>[^)]+)\)\s(?<program>[^\s]+):\s(?<message>.*)')

            );
        };


        rewrite {
            set("${.tmp.host}", value("HOST"));
            set("${.tmp.program}", value("PROGRAM"));
            set("${.tmp.message}", value("MESSAGE"));
        };

        parser {
            date-parser(
                format(
                    '%Y%m%dT%H%M%S%z'
                )
                template("${.tmp.timestamp}")
            );
        };

    };
};

application app-netsource-ericsson_cradlepoint[sc4s-network-source] {
	filter {
        not filter(f_is_source_identified)
        and (
            (
                match("ericsson", value('.netsource.sc4s_vendor'), type(string))
                and match("cradlepoint", value('.netsource.sc4s_product'), type(string))
            )
            and (tags("ns_vendor:ericsson") and tags("ns_product:cradlepoint"))
            or tags(".source.s_ERICSSON_CRADLEPOINT")
            or "${.netsource.sc4s_vendor_product}" eq "ericsson_cradlepoint"
        )
        ;
    };
    parser { app-netsource-ericsson_cradlepoint(); };
};


