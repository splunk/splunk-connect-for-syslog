#Used by fallback to log everything we can
block rewrite r_set_splunk(sourcetype(`splunk-sourcetype`)
                           index(`splunk-index`)
                           template(`splunk-default-template`)
                           vendor("unassigned")
                           category("")
                           filename("messages")
                          ) {
      set("`index`", value(".splunk.index"));
      set("`sourcetype`", value(".splunk.sourcetype"));
      set("`template`", value(".splunk.template"));
      set("`vendor`", value(".splunk.vendor"));
      set("`category`", value(".splunk.category"));
      set("`filename`", value(".splunk.filename"));
      set($FACILITY, value("fields.syslog_facility"));
      set($LEVEL, value("fields.syslog_severity"));
      set($LOGHOST, value("fields.syslog_server"));
      set($RAWMSG, value("RAWMSG"));
  };

#Used when for normal filters index and sourcetype must be set in a prior re-write or context
block rewrite r_set_splunk_basic(
                           template(`splunk-default-template`)
                           vendor("unassigned")
                           category("")
                           filename("messages")
                          ) {
      set("`template`", value(".splunk.template"));
      set("`vendor`", value(".splunk.vendor"));
      set("`category`", value(".splunk.category"));
      set("`filename`", value(".splunk.filename"));
      set($FACILITY, value("fields.syslog_facility"));
      set($LEVEL, value("fields.syslog_severity"));
      set($LOGHOST, value("fields.syslog_server"));
  };


