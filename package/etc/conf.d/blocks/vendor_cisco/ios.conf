rewrite set_metadata_vendor_product_cisco_ios{
    set("cisco_ios" value(".metadata.vendor_product"));
};

filter f_cisco_ios{
    match("cisco_ios", value(".metadata.vendor_product") type(glob));
};

block parser cisco-timestamp-parser(template()) {
    channel {
        filter {
            match('^\*?([A-Za-z]{3} [0-9 ]\d (\d{4} )?\d{2}:\d{2}:\d{2}(\.\d{3})?( (AM|PM))?)' template(`template`) flags(store-matches));
        };
        parser {
            date-parser(format('%b %d %I:%M:%S %p.%f',
                               '%b %d %I:%M:%S %p',
                               '%b %d %H:%M:%S.%f',
                               '%b %d %H:%M:%S',
                               '%b %d %Y %H:%M:%S.%f',
                               '%b %d %Y %H:%M:%S')
                        template("$1"));
        };
        rewrite(set_metadata_vendor_product_cisco_ios);
    };
};

