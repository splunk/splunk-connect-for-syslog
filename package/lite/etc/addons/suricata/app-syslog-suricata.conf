block parser app-syslog-suricata() {
 channel {
    rewrite {
        r_set_splunk_dest_default(
            index('netids')
            sourcetype('suricata')
            vendor("suricata")
            product("suricata")
            template('t_json_values')
        );
    };

    parser {
        json-parser(
            prefix('.values.')
        );
    };

    if {
        filter {
            # Simple Suricata sourcetype: "suricata"
            # Complex Suricata sourcetype: "suricata:flow", "suricata:dns", etc.
            not "`SC4S_SURICATA_SIMPLE_SOURCETYPE`" eq "yes"
            and "${.values.event_type}" ne "";
        };	

        rewrite {
            r_set_splunk_dest_update_v2(
                sourcetype('suricata:${.values.event_type}')
            );
        };
    };

    if {
        filter {
            "${.values.timestamp}" ne "";
        };	

        # 2025-07-04T10:20:33.093102+0000
        parser {
            date-parser(
                format('%Y-%m-%dT%H:%M:%S.%f%z')
                template("${.values.timestamp}")
            );
        };

        rewrite { 
            set-tag("json-timestamp-parsed");
         };
    };
   };
};

application app-syslog-suricata[sc4s-syslog-pgm] {
    filter {
        program('suricata' type(string));
    };	
    parser { app-syslog-suricata(); };
};