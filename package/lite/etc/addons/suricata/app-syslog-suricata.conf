
block parser app-syslog-suricata() {
 channel {
    
    rewrite {
        r_set_splunk_dest_default(
            index('netids')
            sourcetype('suricata')
            vendor("suricata")
            product("suricata")
            template('t_msg_only')
        );
    };

    if {
        parser {
            json-parser(
                prefix('.values.')
            );
        };

        filter {
            "${.values.event_type}" ne "";
        };	

        rewrite {
            r_set_splunk_dest_update_v2(
                sourcetype('suricata:${.values.event_type}')
            );
        };
    };

   };
};

application app-syslog-suricata[sc4s-syslog-pgm] {
	filter {
        program('suricata' type(string));
    };	
    parser { app-syslog-suricata(); };
};